language:
  name: clojure
  binary: clojure
  repl: lein repl
  binaryArgs: -M
  version: |
    clojure-lsp --version
    clojure --version
devcontainer:
  build:
    args:
      JAVA_VERSION: "17"
      CLOJURE_VERSION: "1.11.1.1155"
    base: mcr.microsoft.com/vscode/devcontainers/java:0-${JAVA_VERSION}
    root:
      - ADD https://download.clojure.org/install/linux-install-${CLOJURE_VERSION}.sh /tmp
      - RUN chmod +x /tmp/linux-install-${CLOJURE_VERSION}.sh && /tmp/linux-install-${CLOJURE_VERSION}.sh

      - ADD https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein /usr/local/bin
      - RUN chmod +x /usr/local/bin/lein

      - ADD https://raw.githubusercontent.com/clojure-lsp/clojure-lsp/master/install /tmp/install-clojure-lsp.sh
      - RUN bash /tmp/install-clojure-lsp.sh

      - RUN echo > /conda-notice.txt
  selftest: clojure -M -e '(println "Hello World!")'
vscode:
  settings:
    files.watcherExclude:
      "**/target": true
  extensions:
    - betterthantomorrow.calva
  script: |
    (ns ${TM_FILENAME/^(.*).clj$/$1/}
      (:gen-class))
    (println "----------------")

    $1
