extends: base://java
language:
  name: kotlin
devcontainer:
  publish:
    image: dcc://kotlin
    labels:
      org.opencontainers.image.description: VSCode devcontainer for kotlin
      org.opencontainers.image.source: https://github.com/dhhyi/devcontainer-creator
  build:
    args:
      KTFMT_VERSION: "0.61"
    root:
      - RUN bash -c ". $SDKMAN_DIR/bin/sdkman-init.sh && sdk install kotlin"
      - ADD https://repo1.maven.org/maven2/com/facebook/ktfmt/${KTFMT_VERSION}/ktfmt-${KTFMT_VERSION}-with-dependencies.jar /opt/ktfmt.jar
      - RUN chmod 644 /opt/ktfmt.jar
    files:
      - type: script
        path: /usr/bin/ktfmt
        content: |
          #!/bin/bash
          java -jar /opt/ktfmt.jar "$@"
  selftest: |
    cat >/tmp/helloworld.kt <<EOF
    fun main() { println("Hello World!") }
    EOF
    kotlinc /tmp/helloworld.kt -include-runtime -d /tmp/helloworld.jar
    java -jar /tmp/helloworld.jar
    ktfmt /tmp/helloworld.kt && cat /tmp/helloworld.kt
vscode:
  extensions:
    - fwcd.kotlin
