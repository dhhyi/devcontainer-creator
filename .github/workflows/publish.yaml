# This file is generated by pipeline.js
name: Publish
on:
  push:
    branches:
      - main
jobs:
  calc:
    runs-on: ubuntu-latest
    outputs:
      buildLanguages: ${{ steps.check.outputs.buildLanguages }}
      buildBase: ${{ steps.check.outputs.buildBase }}
      dccClojure: ${{ steps.check.outputs.dccClojure }}
      dccElixir: ${{ steps.check.outputs.dccElixir }}
      dccElm: ${{ steps.check.outputs.dccElm }}
      dccErlang: ${{ steps.check.outputs.dccErlang }}
      dccFactor: ${{ steps.check.outputs.dccFactor }}
      dccGo: ${{ steps.check.outputs.dccGo }}
      dccHaskell: ${{ steps.check.outputs.dccHaskell }}
      dccIdris2: ${{ steps.check.outputs.dccIdris2 }}
      dccIo: ${{ steps.check.outputs.dccIo }}
      dccJulia: ${{ steps.check.outputs.dccJulia }}
      dccKotlin: ${{ steps.check.outputs.dccKotlin }}
      dccLua: ${{ steps.check.outputs.dccLua }}
      dccMoonscript: ${{ steps.check.outputs.dccMoonscript }}
      dccPerl: ${{ steps.check.outputs.dccPerl }}
      dccProlog: ${{ steps.check.outputs.dccProlog }}
      dccPython: ${{ steps.check.outputs.dccPython }}
      dccRaku: ${{ steps.check.outputs.dccRaku }}
      dccRuby: ${{ steps.check.outputs.dccRuby }}
      dccScala: ${{ steps.check.outputs.dccScala }}
      dccTcl: ${{ steps.check.outputs.dccTcl }}
      dccTypescript: ${{ steps.check.outputs.dccTypescript }}
    steps:
      - uses: actions/checkout@master
        with:
          fetch-depth: 2
      - run: npm exec pnpm -- i --prod --ignore-scripts
        name: npm install
      - run: |-
          node pipeline.js
          git diff --exit-code
        name: Check Pipeline
      - id: check
        run: |-
          git diff --name-only HEAD~ | node check-lang-ci.js >> $GITHUB_OUTPUT
          cat $GITHUB_OUTPUT
  bundle:
    uses: ./.github/workflows/bundle.yaml
    secrets: inherit
  features:
    needs:
      - calc
    if: ${{ ! failure() && ! cancelled() && always() }}
    uses: ./.github/workflows/features.yaml
    with:
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  baseDebian:
    needs:
      - calc
      - features
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: base://debian
    uses: ./.github/workflows/base.yaml
    with:
      name: debian
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  baseGo:
    needs:
      - calc
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: base://go
    uses: ./.github/workflows/base.yaml
    with:
      name: go
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  baseJava:
    needs:
      - calc
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: base://java
    uses: ./.github/workflows/base.yaml
    with:
      name: java
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  baseNode:
    needs:
      - calc
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: base://node
    uses: ./.github/workflows/base.yaml
    with:
      name: node
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  basePython:
    needs:
      - calc
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: base://python
    uses: ./.github/workflows/base.yaml
    with:
      name: python
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  baseRuby:
    needs:
      - calc
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: base://ruby
    uses: ./.github/workflows/base.yaml
    with:
      name: ruby
      skip: ${{ needs.calc.outputs.buildBase == 'false' }}
    secrets: inherit
  dccClojure:
    needs:
      - calc
      - bundle
      - baseJava
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://clojure
    uses: ./.github/workflows/dcc.yaml
    with:
      name: clojure
      skip: ${{ needs.calc.outputs.dccClojure == 'false' }}
    secrets: inherit
  dccElixir:
    needs:
      - calc
      - bundle
      - dccErlang
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://elixir
    uses: ./.github/workflows/dcc.yaml
    with:
      name: elixir
      skip: ${{ needs.calc.outputs.dccElixir == 'false' }}
    secrets: inherit
  dccElm:
    needs:
      - calc
      - bundle
      - baseNode
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://elm
    uses: ./.github/workflows/dcc.yaml
    with:
      name: elm
      skip: ${{ needs.calc.outputs.dccElm == 'false' }}
    secrets: inherit
  dccErlang:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://erlang
    uses: ./.github/workflows/dcc.yaml
    with:
      name: erlang
      skip: ${{ needs.calc.outputs.dccErlang == 'false' }}
    secrets: inherit
  dccFactor:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://factor
    uses: ./.github/workflows/dcc.yaml
    with:
      name: factor
      skip: ${{ needs.calc.outputs.dccFactor == 'false' }}
    secrets: inherit
  dccGo:
    needs:
      - calc
      - bundle
      - baseGo
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://go
    uses: ./.github/workflows/dcc.yaml
    with:
      name: go
      skip: ${{ needs.calc.outputs.dccGo == 'false' }}
    secrets: inherit
  dccHaskell:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://haskell
    uses: ./.github/workflows/dcc.yaml
    with:
      name: haskell
      skip: ${{ needs.calc.outputs.dccHaskell == 'false' }}
    secrets: inherit
  dccIdris2:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://idris2
    uses: ./.github/workflows/dcc.yaml
    with:
      name: idris2
      skip: ${{ needs.calc.outputs.dccIdris2 == 'false' }}
    secrets: inherit
  dccIo:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://io
    uses: ./.github/workflows/dcc.yaml
    with:
      name: io
      skip: ${{ needs.calc.outputs.dccIo == 'false' }}
    secrets: inherit
  dccJulia:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://julia
    uses: ./.github/workflows/dcc.yaml
    with:
      name: julia
      skip: ${{ needs.calc.outputs.dccJulia == 'false' }}
    secrets: inherit
  dccKotlin:
    needs:
      - calc
      - bundle
      - baseJava
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://kotlin
    uses: ./.github/workflows/dcc.yaml
    with:
      name: kotlin
      skip: ${{ needs.calc.outputs.dccKotlin == 'false' }}
    secrets: inherit
  dccLua:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://lua
    uses: ./.github/workflows/dcc.yaml
    with:
      name: lua
      skip: ${{ needs.calc.outputs.dccLua == 'false' }}
    secrets: inherit
  dccMoonscript:
    needs:
      - calc
      - bundle
      - dccLua
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://moonscript
    uses: ./.github/workflows/dcc.yaml
    with:
      name: moonscript
      skip: ${{ needs.calc.outputs.dccMoonscript == 'false' }}
    secrets: inherit
  dccPerl:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://perl
    uses: ./.github/workflows/dcc.yaml
    with:
      name: perl
      skip: ${{ needs.calc.outputs.dccPerl == 'false' }}
    secrets: inherit
  dccProlog:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://prolog
    uses: ./.github/workflows/dcc.yaml
    with:
      name: prolog
      skip: ${{ needs.calc.outputs.dccProlog == 'false' }}
    secrets: inherit
  dccPython:
    needs:
      - calc
      - bundle
      - basePython
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://python
    uses: ./.github/workflows/dcc.yaml
    with:
      name: python
      skip: ${{ needs.calc.outputs.dccPython == 'false' }}
    secrets: inherit
  dccRaku:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://raku
    uses: ./.github/workflows/dcc.yaml
    with:
      name: raku
      skip: ${{ needs.calc.outputs.dccRaku == 'false' }}
    secrets: inherit
  dccRuby:
    needs:
      - calc
      - bundle
      - baseRuby
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://ruby
    uses: ./.github/workflows/dcc.yaml
    with:
      name: ruby
      skip: ${{ needs.calc.outputs.dccRuby == 'false' }}
    secrets: inherit
  dccScala:
    needs:
      - calc
      - bundle
      - baseJava
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://scala
    uses: ./.github/workflows/dcc.yaml
    with:
      name: scala
      skip: ${{ needs.calc.outputs.dccScala == 'false' }}
    secrets: inherit
  dccTcl:
    needs:
      - calc
      - bundle
      - baseDebian
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://tcl
    uses: ./.github/workflows/dcc.yaml
    with:
      name: tcl
      skip: ${{ needs.calc.outputs.dccTcl == 'false' }}
    secrets: inherit
  dccTypescript:
    needs:
      - calc
      - bundle
      - baseNode
    if: ${{ ! failure() && ! cancelled() && always() }}
    name: dcc://typescript
    uses: ./.github/workflows/dcc.yaml
    with:
      name: typescript
      skip: ${{ needs.calc.outputs.dccTypescript == 'false' }}
    secrets: inherit
  examples:
    needs:
      - calc
      - dccClojure
      - dccElixir
      - dccElm
      - dccErlang
      - dccFactor
      - dccGo
      - dccHaskell
      - dccIdris2
      - dccIo
      - dccJulia
      - dccKotlin
      - dccLua
      - dccMoonscript
      - dccPerl
      - dccProlog
      - dccPython
      - dccRaku
      - dccRuby
      - dccScala
      - dccTcl
      - dccTypescript
    if: ${{ ! failure() && ! cancelled() && always() }}
    uses: ./.github/workflows/examples.yaml
    with:
      skip: ${{ needs.calc.outputs.buildLanguages == 'false' }}
    secrets: inherit
